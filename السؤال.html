<!DOCTYPE html>
<html lang="ar">
<head>
  <meta charset="UTF-8" />
  <title>Ø°ÙƒØ§Ø¡ Ã— Ø³Ø±Ø¹Ø© - Ø§Ù„Ø³Ø¤Ø§Ù„</title>
  <style>
    body {
      font-family: 'Baloo 2', cursive;
      direction: rtl;
      background: linear-gradient(to bottom right, #e0f7fa, #d0f5e8);
      margin: 0; padding: 0;
      display: flex;
      justify-content: center;
      align-items: center;
      min-height: 100vh;
    }
    .container {
      background: #ffffffcc;
      padding: 30px;
      border-radius: 20px;
      box-shadow: 0 0 15px #999;
      width: 90%;
      max-width: 800px;
      text-align: center;
    }
    .btn {
      padding: 12px 25px;
      margin: 5px;
      font-size: 1.1em;
      border: none;
      border-radius: 12px;
      cursor: pointer;
    }
    .btn-primary { background: #00796b; color: white; }
    .btn-danger  { background: #c0392b; color: white; }
    .btn-secondary { background: #2980b9; color: white; }
    .btn-info { background: #16a085; color: white; }
    .btn-warning { background: #f39c12; color: white; }
    .team-turn, .points {
      font-size: 1.3em;
      color: #004d40;
      font-weight: bold;
    }
    .question {
      font-size: 1.6em;
      margin: 20px 0;
      color: #004d40;
    }
    #answer-box, #luck-result {
      margin-top: 20px;
      font-size: 1.4em;
      color: #004d40;
      display: none;
    }
    .bar {
      height: 28px;
      background-color: #16a085;
      margin: 10px 0;
      border-radius: 10px;
      color: white;
      padding-right: 10px;
      font-weight: bold;
      text-align: right;
    }
    #audience-chart, #countdown {
      display: none;
      margin-top: 20px;
      font-size: 1.3em;
      font-weight: bold;
      color: #8e44ad;
    }

    /* ØªØ£Ø«ÙŠØ± Ø§Ù„Ø¥Ø¬Ø§Ø¨Ø© Ø§Ù„ØµØ­ÙŠØ­Ø© ÙˆØ§Ù„Ø®Ø§Ø·Ø¦Ø© */
    .shake {
      animation: shake 0.4s ease-in-out;
      background-color: #f8d7da !important;
    }
    .flash-success {
      animation: flashGreen 0.6s ease-in-out;
      background-color: #d4edda !important;
    }
    @keyframes shake {
      0% { transform: translateX(0); }
      25% { transform: translateX(-8px); }
      50% { transform: translateX(8px); }
      75% { transform: translateX(-8px); }
      100% { transform: translateX(0); }
    }
    @keyframes flashGreen {
      0% { opacity: 0.8; }
      50% { background-color: #c3e6cb; }
      100% { opacity: 1; }
    }
  </style>
</head>
<body>
  <div class="container">
    <div class="team-turn" id="team-turn"></div>
    <div class="points" id="points"></div>

    <div>
      <button class="btn btn-info" id="audience-btn">ğŸ¤ Ø§Ù„Ø¬Ù…Ù‡ÙˆØ±</button>
      <button class="btn btn-warning" id="luck-btn">ğŸ² Ù†Ø±Ø¯ Ø§Ù„Ø­Ø¸</button>
    </div>

    <div class="question" id="question-text">Ø§Ù„Ø³Ø¤Ø§Ù„ Ù‡Ù†Ø§</div>
    <button class="btn btn-secondary" id="show-answer-btn">ğŸ‘ï¸ Ø¥Ø¸Ù‡Ø§Ø± Ø§Ù„Ø¬ÙˆØ§Ø¨</button>
    <div id="answer-box"></div>
    <div id="luck-result"></div>
    <div id="audience-chart"></div>
    <div id="countdown"></div>

    <div style="margin-top: 20px;">
      <button class="btn btn-primary" id="correct-btn">âœ… Ø¥Ø¬Ø§Ø¨Ø© ØµØ­ÙŠØ­Ø©</button>
      <button class="btn btn-danger" id="wrong-btn">âŒ Ø¥Ø¬Ø§Ø¨Ø© Ø®Ø§Ø·Ø¦Ø©</button>
    </div>
  </div>

  <!-- Ø§Ù„Ø£ØµÙˆØ§Øª -->
  <audio id="crowd-sound" src="crowd.mp3"></audio>
  <audio id="luck-sound" src="select.mp3"></audio>
  <audio id="wrong-sound" src="wrong.mp3"></audio>
  <!-- Ø£ØµÙˆØ§Øª ØµØ­ÙŠØ­Ø© Ù…ØªØ¹Ø¯Ø¯Ø© -->
  <audio class="correct-sound" src="correct1.mp3"></audio>
  <audio class="correct-sound" src="correct2.mp3"></audio>
  <audio class="correct-sound" src="correct3.mp3"></audio>
  <audio class="correct-sound" src="correct4.mp3"></audio>
  <audio class="correct-sound" src="correct5.mp3"></audio>
  <audio class="correct-sound" src="correct6.mp3"></audio>
  <audio class="correct-sound" src="correct7.mp3"></audio>
  <audio class="correct-sound" src="correct8.mp3"></audio>
  <audio class="correct-sound" src="correct9.mp3"></audio>
  <audio class="correct-sound" src="correct10.mp3"></audio>

  <script>
    const currentTeam = parseInt(sessionStorage.getItem("currentTeam")) || 1;
    const points = parseInt(sessionStorage.getItem("currentPoints")) || 200;
    const correctAnswer = sessionStorage.getItem("currentAnswer") || "...";
    const question = sessionStorage.getItem("currentQuestion") || "...";
    const team1 = sessionStorage.getItem("team1") || "ÙØ±ÙŠÙ‚ 1";
    const team2 = sessionStorage.getItem("team2") || "ÙØ±ÙŠÙ‚ 2";

    document.getElementById("team-turn").textContent = `Ø¯ÙˆØ± Ø§Ù„ÙØ±ÙŠÙ‚: ${currentTeam === 1 ? team1 : team2}`;
    document.getElementById("points").textContent = `Ø§Ù„Ù†Ù‚Ø§Ø·: ${points}`;
    document.getElementById("question-text").textContent = question;

    document.getElementById("show-answer-btn").addEventListener("click", () => {
      const box = document.getElementById("answer-box");
      box.textContent = `Ø§Ù„Ø¥Ø¬Ø§Ø¨Ø© Ø§Ù„ØµØ­ÙŠØ­Ø©: ${correctAnswer}`;
      box.style.display = "block";
    });

    document.getElementById("correct-btn").addEventListener("click", () => {
      const body = document.body;
      const sounds = document.querySelectorAll(".correct-sound");
      const randomSound = sounds[Math.floor(Math.random() * sounds.length)];
      randomSound.play();
      body.classList.add("flash-success");
      setTimeout(() => body.classList.remove("flash-success"), 500);

      const teamKey = currentTeam === 1 ? "team1Score" : "team2Score";
      const opponentKey = currentTeam === 1 ? "team2Score" : "team1Score";
      let currentScore = parseInt(sessionStorage.getItem(teamKey)) || 0;
      let opponentScore = parseInt(sessionStorage.getItem(opponentKey)) || 0;
      let earned = points;

      const effect = sessionStorage.getItem("luckEffect");
      if (effect === "double") earned *= 2;
      else if (effect === "half") earned = Math.floor(earned / 2);
      else if (effect === "minus") {
        sessionStorage.setItem(teamKey, Math.max(currentScore - earned, 0));
        alert(`âŒ Ø®ØµÙ… Ø§Ù„Ù†Ù‚Ø§Ø·: -${earned}`);
        sessionStorage.removeItem("luckEffect");
        sessionStorage.setItem("currentTeam", currentTeam === 1 ? "2" : "1");
        return window.location.href = "board.html";
      } else if (effect === "cancel") {
        alert("ğŸš« ØªÙ… Ø¥Ù„ØºØ§Ø¡ Ù‡Ø°Ù‡ Ø§Ù„ÙØ±ØµØ©.");
        sessionStorage.removeItem("luckEffect");
        sessionStorage.setItem("currentTeam", currentTeam === 1 ? "2" : "1");
        return window.location.href = "board.html";
      }

      sessionStorage.setItem(teamKey, currentScore + earned);
      sessionStorage.removeItem("luckEffect");

      if (sessionStorage.getItem("stealMode") === "true") {
        sessionStorage.setItem(opponentKey, Math.max(opponentScore - points, 0));
        sessionStorage.removeItem("stealMode");
        alert(`ğŸ§¨ ØªÙ… Ø®ØµÙ… ${points} Ù…Ù† Ø§Ù„ÙØ±ÙŠÙ‚ Ø§Ù„Ø®ØµÙ…!`);
      }

      alert(`âœ… ØªÙ…Øª Ø¥Ø¶Ø§ÙØ© ${earned} Ù†Ù‚Ø·Ø©!`);
      sessionStorage.setItem("currentTeam", currentTeam === 1 ? "2" : "1");
      window.location.href = "board.html";
    });

    document.getElementById("wrong-btn").addEventListener("click", () => {
      const body = document.body;
      document.getElementById("wrong-sound").play();
      body.classList.add("shake");
      setTimeout(() => body.classList.remove("shake"), 500);
      alert("âŒ Ø¥Ø¬Ø§Ø¨Ø© Ø®Ø§Ø·Ø¦Ø©ØŒ Ù„Ø§ Ù†Ù‚Ø§Ø·.");
      sessionStorage.setItem("currentTeam", currentTeam === 1 ? "2" : "1");
      window.location.href = "board.html";
    });
  </script>
  <script>
  const audienceBtn = document.getElementById("audience-btn");
  const luckBtn = document.getElementById("luck-btn");

  audienceBtn?.addEventListener("click", () => {
    audienceBtn.disabled = true;
    audienceBtn.textContent = "ğŸ¤ Ø§Ù„Ø¬Ù…Ù‡ÙˆØ± (ØªÙ… Ø§Ù„Ø§Ø³ØªØ®Ø¯Ø§Ù…)";
    document.getElementById("crowd-sound").play();
    const chart = document.getElementById("audience-chart");
    const countdown = document.getElementById("countdown");
    chart.innerHTML = "";
    chart.style.display = "block";

    const options = ["Ø£", "Ø¨", "Ø¬", "Ø¯"];
    const correctIndex = Math.floor(Math.random() * 4);
    const votes = [0, 0, 0, 0];
    votes[correctIndex] = 55 + Math.floor(Math.random() * 16);
    let remaining = 100 - votes[correctIndex];
    const others = [0, 1, 2, 3].filter(i => i !== correctIndex);
    for (let i = 0; i < others.length; i++) {
      const share = i < others.length - 1 ? Math.floor(Math.random() * (remaining + 1)) : remaining;
      votes[others[i]] = share;
      remaining -= share;
    }

    options.forEach((label, i) => {
      const bar = document.createElement("div");
      bar.className = "bar";
      bar.style.width = votes[i] + "%";
      bar.textContent = `${label}: ${votes[i]}Ùª`;
      chart.appendChild(bar);
    });

    let seconds = 10;
    countdown.textContent = `â³ ${seconds} Ø«Ø§Ù†ÙŠØ©...`;
    countdown.style.display = "block";
    const timer = setInterval(() => {
      seconds--;
      countdown.textContent = `â³ ${seconds} Ø«Ø§Ù†ÙŠØ©...`;
      if (seconds <= 0) {
        clearInterval(timer);
        chart.style.display = "none";
        countdown.style.display = "none";
      }
    }, 1000);
  });

  luckBtn?.addEventListener("click", () => {
    luckBtn.disabled = true;
    luckBtn.textContent = "ğŸ² Ù†Ø±Ø¯ Ø§Ù„Ø­Ø¸ (ØªÙ… Ø§Ù„Ø§Ø³ØªØ®Ø¯Ø§Ù…)";
    document.getElementById("luck-sound").play();
    const resultBox = document.getElementById("luck-result");
    const outcomes = [
      "ğŸ¯ Ù†Ù‚Ø§Ø· Ù…Ø¶Ø§Ø¹ÙØ©",
      "ğŸš« Ø¥Ù„ØºØ§Ø¡ Ø§Ù„ÙØ±ØµØ©",
      "ğŸ’¸ Ù†ØµÙ Ø§Ù„Ù†Ù‚Ø§Ø·",
      "âŒ Ø®ØµÙ… Ø§Ù„Ù†Ù‚Ø§Ø·"
    ];
    const selected = outcomes[Math.floor(Math.random() * outcomes.length)];
    resultBox.textContent = `Ù†ØªÙŠØ¬Ø© Ø§Ù„Ù†Ø±Ø¯: ${selected}`;
    resultBox.style.display = "block";
    resultBox.style.animation = "flash 0.5s ease-in-out infinite alternate";
    setTimeout(() => {
      resultBox.style.animation = "none";
    }, 3000);
    if (selected.includes("Ù…Ø¶Ø§Ø¹ÙØ©")) sessionStorage.setItem('luckEffect', 'double');
    else if (selected.includes("Ù†ØµÙ")) sessionStorage.setItem('luckEffect', 'half');
    else if (selected.includes("Ø®ØµÙ…")) sessionStorage.setItem('luckEffect', 'minus');
    else if (selected.includes("Ø¥Ù„ØºØ§Ø¡")) sessionStorage.setItem('luckEffect', 'cancel');
  });
</script>

</body>
</html>
